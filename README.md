# 🏢 네이버 부동산 하이브리드 수집기

상가/사무실 매물을 대량으로 수집하는 하이브리드 스크래퍼 시스템입니다.

## ✨ 주요 특징

### 🥷 **스텔스 기술**
- **다중 세션**: 5개 세션 로테이션으로 봇 탐지 우회
- **인간 행동 모방**: 랜덤 대기시간, 다양한 User-Agent
- **부동산전문가/일반사용자** 페르소나별 행동 패턴
- **스마트 세션 리셋**: 자동 세션 갱신으로 무한 수집

### 🎯 **정확한 필터링**
- **보증금**: 2,000만원 이하
- **월세**: 130만원 이하 (관리비 포함 150만원)
- **층수**: 지하1층~2층
- **면적**: 20평(66㎡) 이상
- **관리비**: 30만원 이하

### 🚀 **하이브리드 방식**
1. **브라우저 단계**: "구만 보기" 버튼으로 정확한 지역 설정
2. **API 단계**: 네이버 내부 API로 대량 수집 (페이지당 20개)

## 📊 수집 성능

- **수집량**: 구별 최대 400개 (총 20,000개 가능)
- **조건 부합률**: 16.4% (실제 사용 가능한 매물)
- **정확도**: 100% 정확한 구별 분류
- **링크 포함**: 모든 매물의 네이버 링크 완전 수집

## 🛠️ 사용법

### 설치
```bash
pip install playwright requests pandas sqlite3
playwright install chromium
```

### 실행
```bash
# 가상환경 활성화
source venv/bin/activate

# 하이브리드 수집기 실행 (5개구 샘플)
python district_button_collector.py

# Streamlit UI로 결과 확인
streamlit run streamlit_property_app.py
```

## 📁 파일 구조

- **`district_button_collector.py`** - 메인 하이브리드 수집기
- **`streamlit_property_app.py`** - Streamlit UI 앱
- **`data_processor.py`** - 데이터 처리 및 저장
- **`조건.md`** - 매물 필터링 조건 정의

## 🎮 실시간 로그

```
📍 1/5: 강남구 하이브리드 수집
         🌐 1단계: 브라우저로 강남구만 보기 활성화...
         ✅ 강남구만 보기 클릭 완료
         🚀 2단계: 강남구 필터 상태에서 API 대량 수집...
            🥷 스텔스 API 수집 시작 (최대 20페이지)
               📄 1페이지 (스텔스 모드)...
                  ✅ 20개 원시 데이터
                  ✅ 20개 처리 완료 (누적: 20개)
```

## 📈 수집 결과

### 수집 통계
- 총 매물: 2,000개
- 매물 타입: 사무실(72%), 상가(28%)
- 거래 타입: 월세 100%
- 조건 부합: 327개 (16.4%)

### 구별 분포
| 구 | 수집량 | 조건부합 |
|---|-------|---------|
| 강남구 | 400개 | 65개 |
| 강서구 | 400개 | 72개 |
| 영등포구 | 400개 | 68개 |
| 구로구 | 400개 | 61개 |
| 마포구 | 400개 | 61개 |

## 🔧 설정 변경

`district_button_collector.py`에서 수집 설정 변경 가능:

```python
# 수집할 구 리스트
DISTRICTS = ["강남구", "강서구", "영등포구", "구로구", "마포구"]

# 구별 최대 페이지 수 (페이지당 20개)
MAX_PAGES_PER_DISTRICT = 20  # 400개
```

## ⚠️ 주의사항

- **봇 탐지 우회**: 스텔스 기능으로 안전하지만 과도한 사용 자제
- **서버 부하**: 적절한 대기시간으로 서버 부하 최소화
- **개인 용도**: 상업적 이용 전 네이버 이용약관 확인 필요

## 📊 데이터 출력

- **CSV**: `api_mass_collection_YYYYMMDD_HHMMSS.csv`
- **JSON**: `api_mass_collection_YYYYMMDD_HHMMSS.json`
- **DB**: `data/properties.db` (SQLite)

---

*2025년 최신 네이버 부동산 API 대응 | 스텔스 기술 적용*